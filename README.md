# ChineseSubjectRecognition
### 人机对话场景下的句子主体识别
项目中数据为NLPCC 2019 论文: Subject Recognition in Chinese Sentences for Chatbots 所公开的人机对话主体数据集。

论文摘要： 针对聊天机器人在人机交互过程中句子核心主体“你”、“我”不分导致机器人意图识别错误、答非所问的问题，本文提出了人机对话特定领域下的主体识别方法。首先，根据工业界真实人机交互语料，提出了一套基于单句的主体分类标注规范；然后，基于该规范构建了主体数据集；最后，提出了基于深度神经网络的主体分类模型，并评测了主体识别对人机对话系统的提升。结果表明，主体识别效果F1值达88.5%，在3款业界主流聊天机器人上平均提升对话主体识别率为5.7%。

关键词： 聊天机器人；主体识别；人机对话系统；深度神经网络

### 一、数据说明

本文共公开4份数据：

| 数据名               | 说明               | 条数  |
| -------------------- | ------------------ | ----- |
| train_set.csv        | 训练集             | 31446 |
| val_set.csv          | 验证集             | 4448  |
| test_set.csv         | 测试集             | 9030  |
| manual_eval_data.txt | 集外人工评测数据集 | 1015  |

csv文件读取方法：

    import pandas as pd
    df = pd.read_csv('train_set.csv')

​	三份为神经网络模型训练数据，格式为csv，合计44924条，按如下比例划分：70%为训练集（31446条）、10%为验证集（4448条）、20%为测试集（9030条），另外还有一份为1015条人工评测的问句。

### 二、数据标注规范

#### 2.1	 主体分类的范畴

​	本文讨论的主体范畴，都是限定的 。可以作为主体的有：人称代词、人名、人的属性、人的身体部位、人的所属物品、人际关系、特定拟人化的动物等。例如：我、你、他们、张三、我的生日、我的眼睛、我妈妈、我的手机、我家二哈等。

本文共定义了五类主体的标签：“我”、“你”、“双方”、“其他”和“无”。

1) **我**：为句子的讲述者，第一人称（我、我们、咱等）、我的属性、我的身体部位、我的所属物品、明显省略主体为“我”的句子。

2) **你**：为对话的讲述对象，第二人称、机器人名字、你的属性、你的身体部位、你的所属物品、明显省略主体为“你”的句子。

3) **双方**：句子核心内容描述由讲述者和讲述对象共同做的事。例如：“我和你一样美”。

4) **其他**：非句子讲述者和讲述对象的其他主体，通常为第三人称、非代指用户或机器人的其他人名、特指的人或人的群体、特指的动物。

5) **无**： ①  非以上四类的词做主语成分时，标无主体，通常有：物品、时间词、地点词、状态词、抽象词汇、抽象事情和专有名词等。②  无主句，即句子本身已能“自足”，不要补充任何词作为主语，如：“下雨了”。③  句子省略了主语成分，且省略的主语无法确定的情况。

#### 2.2	 通用规则

基于人工标注大量数据以后，根据句子的结构，我们抽象出五条通用规则，适用于大多数句子的标注。

1）主(……)  

主语开头，后不接其他宾语的简单句，标主语为主体

e.g. **我**很开心  ==》标 “我”

2）主谓宾 

主谓宾句子，宾语非从句，标主语为主体

e.g. **我**喜欢你  ==》标 “我”

3）主谓宾从

主谓宾句子，宾语为从句，根据句子核心通常标宾从主语为主体

e.g. 我说**你**是不是傻啊  ==》标 “你”

e.g. 我觉得你很可爱  ==》标 “你”

4）谓宾，主语省略

（省略主语的）谓宾句子，宾语非从句，省略主语可以明显补充的，标省略主语为主体

e.g. **（我）**被人打了 ==》标 “我”

e.g. **（你）**帮我定闹钟 ==》标 “你”

5）谓宾从，主语省略

（省略主主语的）谓宾句子，且宾语为从句，根据句子核心通常标宾从主语为主体

e.g. 祝你生日快乐  ===》“你”

e.g. 希望你能陪我聊天   ===》“你”

但是核心还是要具体情况还需具体分析，并非所有满足以上结构的句子均按照通用规则进行标注，还是需要先找出句子的核心部分，然后看核心部分的主体是谁，则标谁。

#### 2.3	 主语省略情况下的缺省处理

在人机对话这一特定场景下，一些情况下主体省略，可以补充一个默认的主体。
1)	省略的主体默认为“我”的情况

* 只有谓宾结构的句子，且宾语为第二人称。例如：爱你，感谢你。
* 省略主语，句子描述情绪和人的心理状态。例如：今天过得很开心，受伤了难受。

2)	省略的主体默认为“你”的情况

* 机器人功能性句子，且有完整谓词成分的祈使句。例如：帮忙定个10点的闹钟。 	
* 谓宾结构，宾语为讲述者“我”，根据具体情况可补充为“你”。例如：给我笑一个。

3)	明显方向性动词，根据方向进行主体补充

明显有方向性的动词：把、被、给、帮、替、告诉等，通常情况下，将这些方向性谓词前面的部分标注为主体，如果省略主体的，可以根据谓词后接的人称代词来补充对应方向的主体。

e.g. “快要被你气死了”可以补充主体“我”；“告诉我你的秘密”可以补充主体“你”；“把天边最美的云彩送给你”可以补充主体“我”。

#### 2.4	 句子多谓语时的主体选择

​	当一个句子为并列复句或复杂句时，通常有不止一个谓语，此时对于多谓语如何选择一个作为侧重点时有以下几个方面可以作为参考。

1)	优先考虑包含机器人功能性的部分。

例如：“我不开心，你给我放首歌吧”可选择句子后半部分作为侧重点标注主体，标“你”。

2)	并列成分中包含情感或情绪时，刻优先选择情感和情绪的部分。

3)	因果关系中，优先选择原因中的主体。

e.g. “你的魅力太大我抵挡不住”主体为“你”。

4)	两个完全并列的成分中，可统一选择前者中的主体。

以上四条均为本文数据集标注过程中采用的启发式规则，具体应用场景下，可以根据实际情况进行调整。将每个并列成分做拆分做拆分，再分别根据分句的核心内容进行主体标注是另一种解决方案。

#### 2.5	 其他规则

1)	含人称代词的脏话、口头禅或语气词，通常视为无主体，标“无”

例如：我靠、他妈的、我的天吶、我勒个去，标“无”。

2)	省略导致严重歧义的句子主体标注

例如：“加油妈妈爱你”，这个句子有两个谓语，"加油"和"爱"，根据侧重不同句子停顿不同，可以补充上不同的省略内容，可以理解为3种语义：

* 加油妈妈 （我）爱你，侧重加油，主体为“妈妈”，侧重感情表达，主体为“我”；
* （你）加油 妈妈爱你，侧重加油，主体为“你”，侧重感情表达，主体为“妈妈”； 
* （你）加油 我爱你，“妈妈”可看做用户对自己的称呼，侧重加油，主体为“你”，侧重感情表达，主体为“我”。 	

在人机对话的特定场景下，我们优先理解语义为第三种语义，根据用户情感优先的原则，可以标注为“我”。